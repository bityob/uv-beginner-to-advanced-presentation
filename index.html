<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    <title></title>
    <link rel="stylesheet" href="dist/reveal.css" />
    <link rel="stylesheet" href="dist/theme/serif.css" id="theme" />
    <link rel="stylesheet" href="plugin/highlight/zenburn.css" />
	<link rel="stylesheet" href="css/layout.css" />
	<link rel="stylesheet" href="plugin/customcontrols/style.css">



    <script defer src="dist/fontawesome/all.min.js"></script>

	<script type="text/javascript">
		var forgetPop = true;
		function onPopState(event) {
			if(forgetPop){
				forgetPop = false;
			} else {
				parent.postMessage(event.target.location.href, "app://obsidian.md");
			}
        }
		window.onpopstate = onPopState;
		window.onmessage = event => {
			if(event.data == "reload"){
				window.document.location.reload();
			}
			forgetPop = true;
		}

		function fitElements(){
			const itemsToFit = document.getElementsByClassName('fitText');
			for (const item in itemsToFit) {
				if (Object.hasOwnProperty.call(itemsToFit, item)) {
					var element = itemsToFit[item];
					fitElement(element,1, 1000);
					element.classList.remove('fitText');
				}
			}
		}

		function fitElement(element, start, end){

			let size = (end + start) / 2;
			element.style.fontSize = `${size}px`;

			if(Math.abs(start - end) < 1){
				while(element.scrollHeight > element.offsetHeight){
					size--;
					element.style.fontSize = `${size}px`;
				}
				return;
			}

			if(element.scrollHeight > element.offsetHeight){
				fitElement(element, start, size);
			} else {
				fitElement(element, size, end);
			}		
		}


		document.onreadystatechange = () => {
			fitElements();
			if (document.readyState === 'complete') {
				if (window.location.href.indexOf("?export") != -1){
					parent.postMessage(event.target.location.href, "app://obsidian.md");
				}
				if (window.location.href.indexOf("print-pdf") != -1){
					let stateCheck = setInterval(() => {
						clearInterval(stateCheck);
						window.print();
					}, 250);
				}
			}
	};


        </script>
  </head>
  <body>
    <div class="reveal">
      <div class="slides"><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### uv: An Extremely Fast Python Package Manager

**RND Light-Talk**, December 2024

Yonatan Bitton / [@bityob](https://linktr.ee/bityob)

[bit.ly/uv-intro](https://bit.ly/uv-intro)

<img src="Pasted image 20241224034213.png" alt="" style="width: 150px; object-fit: fill">



Notes:
<img src="Pasted image 20241223173216.png" alt="" style="width: 300px; object-fit: fill">
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### A fast, all-in-one Python package manager

- &shy;<!-- .element: class="fragment" data-fragment-index="1" -->You can use uv to: install Python, create virtual environments, resolve dependencies, install packages, build packages and more
- &shy;<!-- .element: class="fragment" data-fragment-index="2" -->A drop-in alternative to `pip`, `pipx`, `pyenv`, `virtualenv`, `poetry` and more
- &shy;<!-- .element: class="fragment" data-fragment-index="3" -->A single static binary that gives you everything you need to be productive with Python
- &shy;<!-- .element: class="fragment" data-fragment-index="4" -->10-100x faster than alternatives. Written in Rust
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### New Tool, Big Impact

- &shy;<!-- .element: class="fragment" data-fragment-index="1" -->21+ million downloads last month
- &shy;<!-- .element: class="fragment" data-fragment-index="2" -->33.3k stars in GitHub
- &shy;<!-- .element: class="fragment" data-fragment-index="3" -->6.8+ billion packages were downloaded using UV last month, which is 13% of total downloads
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

<img src="Pasted image 20241223171715.png" alt="" style="object-fit: scale-down">
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### Agenda

- &shy;<!-- .element: class="fragment" data-fragment-index="1" -->Overview
	- Installation
	- pip interface
	- uv commands
- &shy;<!-- .element: class="fragment" data-fragment-index="2" -->The uv ecosystem
	- Projects
	- Tools
	- Scripts
- &shy;<!-- .element: class="fragment" data-fragment-index="3" -->Why UV is so fast?
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### Installation 

- No need to have Python/Rust installed to install UV

```bash
curl -LsSf https://astral.sh/uv/install.sh | sh
```

```powershell
powershell -c "irm https://astral.sh/uv/install.ps1 | iex"
```

- Alternatively, can be installed using `pip` or `pipx`

```bash
pip install uv
pipx install uv
```
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### pip interface

- &shy;<!-- .element: class="fragment" data-fragment-index="1" -->Drop-in replacement for common `pip` and `virtualenv` commands
- &shy;<!-- .element: class="fragment" data-fragment-index="2" -->Creating a virtual environment: `uv venv`
- &shy;<!-- .element: class="fragment" data-fragment-index="3" -->Install a package: `uv pip install flask`
- &shy;<!-- .element: class="fragment" data-fragment-index="4" -->List packages: `uv pip freeze`
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

```python [1-4|5-14|15-22]
$ uv venv
Using CPython 3.10.14
Creating virtual environment at: .venv
Activate with: source .venv/bin/activate
$ uv pip install flask
Resolved 7 packages in 491ms
Installed 7 packages in 13ms
 + blinker==1.9.0
 + click==8.1.8
 + flask==3.1.0
 + itsdangerous==2.2.0
 + jinja2==3.1.5
 + markupsafe==3.0.2
 + werkzeug==3.1.3
$ uv pip freeze
blinker==1.9.0
click==8.1.8
flask==3.1.0
itsdangerous==2.2.0
jinja2==3.1.5
markupsafe==3.0.2
werkzeug==3.1.3
```
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### uv commands
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### uv commands


|uv command|pip command(s)|Notes|
|---|---|---|
|`uv init <name>`|N/A|creates a new empty project according to the `pyproject.toml` specification|
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### uv commands

|uv command|pip command(s)|Notes|
|---|---|---|
|`uv add <package>`|`pip install <package>`|uv also adds it to the `pyproject.toml` and update the `uv.lock` file|
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

Since we are using docker to run our applications, you can't run `uv add <package>` on local, since it will try to **install the packages too.**

For such cases, just run with `--no-sync` flag

```
uv add <package> --no-sync
```
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### uv commands

|uv command|pip command(s)|Notes|
|---|---|---|
|`uv lock`|`N/A`|creates the `uv.lock` file with all pinned dependencies|
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### uv commands

|uv command|pip command(s)|Notes|
|---|---|---|
|`uv sync`|`pip freeze \| xargs pip uninstall -y && pip install -r requirements.txt`|uv also creates a venv if it doesn't exist|
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### uv commands

|uv command|pip command(s)|Notes|
|---|---|---|
|`uv run <python_file>`|`source .venv/activate && python <python_file>`||
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### uv commands

|uv command|pip command(s)|Notes|
|---|---|---|
|`uv remove <package>`|`pip uninstall <package> && pip freeze > requirements.txt`||
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

```python [1-2|3-10|11-14|15-24]
$ uv init
Initialized project `playground`
$ cat pyproject.toml
[project]
name = "playground"
version = "0.1.0"
description = "Add your description here"
readme = "README.md"
requires-python = ">=3.10"
dependencies = []
$ uv add pycowsay
Resolved 2 packages in 346ms
Installed 1 package in 7ms
 ++ pycowsay==0.0.0.2
$ uv run pycowsay "Hello Python World!"

  -------------------
< Hello Python World! >
  -------------------
   \   ^__^
    \  (oo)\_______
       (__)\       )\/\
           ||----w |
           ||     ||
```
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### uv commands


|uv command|pip command(s)|Notes|
|---|---|---|
|`uv python list`|N/A|list all python versions installed on your **computer**|
|`uv python install <version>`|N/A|using precompiled binaries|
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

```python [1-11|12-14]
$ uv python list
cpython-3.13.0a0-linux-x86_64-gnu               /usr/local/bin/python3.13
cpython-3.12.7-linux-x86_64-gnu                 <download available>
cpython-3.12.0-linux-x86_64-gnu                 /home/linuxbrew/.linuxbrew/opt/python@3.12/bin/python3.12
cpython-3.11.10-linux-x86_64-gnu                <download available>
cpython-3.11.6-linux-x86_64-gnu                 /home/linuxbrew/.linuxbrew/opt/python@3.11/bin/python3.11
cpython-3.11.4-linux-x86_64-gnu                 /home/bit/.asdf/installs/python/3.11.4/bin/python3.11
cpython-3.11.4-linux-x86_64-gnu                 /home/bit/.asdf/installs/python/3.11.4/bin/python3 -> python3.11
cpython-3.11.4-linux-x86_64-gnu                 /home/bit/.asdf/installs/python/3.11.4/bin/python -> python3.11
cpython-3.10.15-linux-x86_64-gnu                <download available>
...
$ uv python install cpython-3.10.15-linux-x86_64-gnu
Installed Python 3.10.15 in 4.74s
 + cpython-3.10.15-linux-x86_64-gnu
```
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### uv ecosystem
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### Projects 

- Python projects/repositories
- Using with `uv` commands like previous slides
- Configuration file is inside `pyproject.toml`
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### Tools

- CLI tools, e.g `ruff`, `llm`, `pycowsay`
- No file needed
- Virtual environment included
- Same like `pipx` tool

```
uvx <tool>
uv tool run <tool>
```

```
$ uvx art text "Hello World!"
 _   _        _  _         __        __              _      _  _
| | | |  ___ | || |  ___   \ \      / /  ___   _ __ | |  __| || |
| |_| | / _ \| || | / _ \   \ \ /\ / /  / _ \ | '__|| | / _` || |
|  _  ||  __/| || || (_) |   \ V  V /  | (_) || |   | || (_| ||_|
|_| |_| \___||_||_| \___/     \_/\_/    \___/ |_|   |_| \__,_|(_)
```
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### Scripts

- Scripts are single files without project files
- A script without dependencies is easy, just `uv run <script>` 
- But how can we run a script with dependencies??
- &shy;<!-- .element: class="fragment" data-fragment-index="1" -->uv supports specifying dependencies **on invocation**
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

```python [1-12|14-19]
$ cat http_requests_uuid.py
import concurrent.futures

urls = ["https://httpbin.org/uuid" for _ in range(5)]

def get_url(url):
    import requests
    return requests.get(url).json()

with concurrent.futures.ThreadPoolExecutor(3) as executor:
    for x in executor.map(get_url, urls):
        print(x)

$ uv run --with requests http_requests_uuid.py
{'uuid': '2f9c8816-960f-40e8-a26e-a0ada4b4c5cc'}
{'uuid': '22d43f6c-7f81-46d1-867c-43260b0155bb'}
{'uuid': '3303265d-1d9c-41ac-a43e-5a9fed0aa02c'}
{'uuid': 'bed4fdd9-0e7b-4641-b9ed-19889e435c42'}
{'uuid': '6944a068-67d9-4778-bb40-2b77c9115e5e'}
```
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

But this can be done even better
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

<img src="Pasted image 20241223185623.png" alt="" style="object-fit: scale-down">


https://peps.python.org/pep-0723/
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

Now we can use something like this 

```python [1-2|3-9|3-20|21-27]
$ uv add --script http_requests_uuid.py requests
Updated `http_requests_uuid.py`
$ cat http_requests_uuid.py
# /// script
# requires-python = ">=3.10"
# dependencies = [
#     "requests",
# ]
# ///
import concurrent.futures

urls = ["https://httpbin.org/uuid" for _ in range(5)]

def get_url(url):
    import requests
    return requests.get(url).json()

with concurrent.futures.ThreadPoolExecutor(3) as executor:
    for x in executor.map(get_url, urls):
        print(x)
$ uv run http_requests_uuid.py
Reading inline script metadata from `http_requests_uuid.py`
{'uuid': '6d852239-642d-46e1-9718-0f0862808b91'}
{'uuid': 'b70dfc29-5cbc-4f36-9476-fd1c79ec32c0'}
{'uuid': 'c790752b-681a-45d2-af17-38fb44917612'}
{'uuid': 'd22336bb-cd53-40d9-b1cb-c2348cdcdac6'}
{'uuid': '81e9cda6-6072-4fd8-80b0-08cc55553fd5'}
```
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

You can limit uv to only considering distributions released before a specific date

```python [7|1-15]
$ cat example_requests.py
# /// script
# dependencies = [
#   "requests",
# ]
# [tool.uv]
# exclude-newer = "2020-10-16T00:00:00Z"
# ///

import requests

print(requests.__version__)
$ uv run example_requests.py
Reading inline script metadata from `example_requests.py`
2.24.0
```

<div style="position: fixed; bottom: 0; width: 100%; text-align: center; font-size: 70%; color: gray;">
<a href="https://docs.astral.sh/uv/guides/scripts/">Source: https://docs.astral.sh/uv/guides/scripts/</a>
</div><!-- .element: class="fragment" -->
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

Now, the interesting thing...

### Why UV is so fast?
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### (1)

Written in pure **Rust**.

100k~ lines of code.

But... uv has gotten significantly faster over time <!-- .element: class="fragment" -->
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### (2)

Fast python install using precompiled binaries.

<img src="Pasted image 20241223235115.png" alt="" style="object-fit: scale-down" class="fragment">


Really, there are around 400 builds (including checksum files), but still! <!-- .element: class="fragment" -->
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### (3)

Version parsing.

- &shy;<!-- .element: class="fragment" data-fragment-index="1" -->`1.0.0`
- &shy;<!-- .element: class="fragment" data-fragment-index="2" -->`2.3.1-beta.1`
- &shy;<!-- .element: class="fragment" data-fragment-index="3" -->`1.0.post345`
- &shy;<!-- .element: class="fragment" data-fragment-index="4" -->`1.2.3.4.5-a8.post9`

Representing these is pretty hard. <!-- .element: class="fragment" -->

<div style="position: fixed; bottom: 0; width: 100%; text-align: center; font-size: 70%; color: gray;">
<a href="https://youtu.be/gSKTfG1GXYQ?t=1544">Source: https://youtu.be/gSKTfG1GXYQ?t=1544</a>
</div><!-- .element: class="fragment" -->
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

The full representation of this is

```rust
struct VersionFull {
    epoch: u64,
    release: Vec<u64>,
    pre: Option<Prerelease>,
    post: Option<u64>,
    dev: Option<u64>,
    local: LocalVersion,
    min: Option<u64>,
    max: Option<u64>,
}
```

Notes:
- Vectors, memory allocation, release segments,
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

Apparently, we can represent over 90% of versions with a single u64.

```rust
struct VersionSmall(u64);
```

<img src="Pasted image 20241224010957.png" alt="" style="object-fit: scale-down" class="fragment">


<div style="position: fixed; bottom: 0; width: 100%; text-align: center; font-size: 70%; color: gray;">
Credit to Andrew Gallant (@BurntSushi)
</div><!-- .element: class="fragment" -->
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### And the Best Part:

- &shy;<!-- .element: class="fragment" data-fragment-index="1" -->Greater versions map to larger integers 
	→ Simplifies comparison
- &shy;<!-- .element: class="fragment" data-fragment-index="2" --> Version comparison becomes extremely fast
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

<img src="Pasted image 20241224021528.png" alt="" style="object-fit: scale-down">
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### (4) 

### Reading package `METADATA`

- &shy;<!-- .element: class="fragment" data-fragment-index="1" -->Built distributions (wheels) are packaged as zip archive
- &shy;<!-- .element: class="fragment" data-fragment-index="2" -->Somewhere in the zip, there's a `METADATA` file
- &shy;<!-- .element: class="fragment" data-fragment-index="3" -->Some registries expose it directly, some don't
- &shy;<!-- .element: class="fragment" data-fragment-index="4" -->**Goal:** avoid downloading the entire zip just to read the `METADATA`


<div style="position: fixed; bottom: 0; width: 100%; text-align: center; font-size: 70%; color: gray;">
<a href="https://youtu.be/gSKTfG1GXYQ?t=1884">Source: https://youtu.be/gSKTfG1GXYQ?t=1884</a>
</div><!-- .element: class="fragment" -->
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

<img src="Pasted image 20241224013805.png" alt="" style="object-fit: scale-down">



<div style="position: fixed; bottom: 0; width: 100%; text-align: center; font-size: 70%; color: gray;">
<a href="https://en.wikipedia.org/wiki/ZIP_(file_format)">Source: Wikipedia</a>
</div><!-- .element: class="fragment" -->
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

- HTTP Range request the Central Directory
- &shy;<!-- .element: class="fragment" data-fragment-index="1" -->Locate the `METADATA` file by reading the Central Directory
- &shy;<!-- .element: class="fragment" data-fragment-index="2" -->HTTP Range request the `METADATA` file

```
GET /example.whl HTTP/1.1
Host: example.com
Range: bytes=-100
```
<!-- .element: class="fragment" -->
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### (5)

### Cache design

- &shy;<!-- .element: class="fragment" data-fragment-index="1" -->**Global cache of unpacked archives:** uv uses aggressive caching to avoid re-downloading (and re-building) dependencies that have already been accessed in prior runs
- &shy;<!-- .element: class="fragment" data-fragment-index="2" -->**Most installs are just:** hardlink a bunch of files from one place to another
- &shy;<!-- .element: class="fragment" data-fragment-index="3" -->Really fast and very space efficient
- &shy;<!-- .element: class="fragment" data-fragment-index="4" -->This only applies for files, not for metadata
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

For metadata, there is another **last** hack called,

**Zero-copy deserialization.**
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### (6)

### Zero-copy deserialization

A technique that reduces the time and memory required to access and use data by **directly referencing bytes in the serialized form**


<div style="position: fixed; bottom: 0; width: 100%; text-align: center; font-size: 70%; color: gray;">
<a href="https://rkyv.org/zero-copy-deserialization.html">Source: https://rkyv.org/zero-copy-deserialization.html</a>
</div><!-- .element: class="fragment" -->
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

Simple zero-copy

```rust
{ "quote": "I don't know, I didn't listen." }
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
```
<!-- .element: class="fragment" -->

```rust
struct NonZeroCopy {
    quote: String,
}

struct ZeroCopy<'a> {
    quote: &'a str,
}
```
<!-- .element: class="fragment" -->
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

Total zero-copy

- &shy;<!-- .element: class="fragment" data-fragment-index="1" -->Using **total zero-copy** guarantees that no data is copied during deserialization and no work is done to deserialize data
- &shy;<!-- .element: class="fragment" data-fragment-index="2" -->It achieves this by structuring its encoded representation so that it is the same as the in-memory representation of the source type
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

```rust
struct Example {
  quote: String,
  a: [u8; 12],
  b: u64,
  c: char,
}
```

<img src="Pasted image 20241224024718.png" alt="" style="object-fit: scale-down">
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

- On `json`, first you read the file from disc, then run a parser, and then you grab the contents and put them in the struct. All these operations would get **slower and slower as the data got bigger**
- This operation doesn't **scale** with our data. No matter how much or how little data we have
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

- On uv they store metadata in disc in the same representation like the in-memory representation of the `json`. Now, you just need to read from disc, no need to parse it again and allocate a lot of memory for that
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### In Summary: Why Python UV Tool Matters

- **Impressive Performance**: The effort to make this tool fast is remarkable. It's a testament to Python's potential in high-performance tasks.
- **Cool and Innovative**: The features and design are both practical and elegant—truly worth exploring.
- **Highly Recommended**: Start experimenting with it today and see the results for yourself!
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### Questions?
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### Sources 

- Sane Python dependency management with uv ([florianbrand.de](https://florianbrand.de/posts/uv-intro))
- Charlie Marsh (founder of Astral) Presentation on Jane Street ([youtube](https://www.youtube.com/watch?v=gSKTfG1GXYQ&t=3s&ab_channel=JaneStreet))
- uv: Unified Python packaging ([astral.sh](https://astral.sh/blog/uv-unified-python-packaging))
- uv: Python packaging in Rust ([astral.sh](https://astral.sh/blog/uv))
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### Learn More (1)

- pip vs. uv: How Streamlit Cloud sped up app load times by 55% ([blog.streamlit.io](https://blog.streamlit.io/content/images/size/w1200/2024/07/_Users_lacosta_Downloads_Announcement-20-3-.svg.png))
- GitHub - `astral-sh/uv`: An extremely fast Python package and project manager, written in Rust ([github](https://github.com/astral-sh/uv))
- Python Packaging is Great Now: `uv` is all you need ([dev.to](https://dev.to/astrojuanlu/python-packaging-is-great-now-uv-is-all-you-need-4i2d))
- Python Packaging Is Good Now (2016) ([blog.glyph.im](https://blog.glyph.im/2016/08/python-packaging.html))
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

### Learn More (2)

- Poetry versus uv ([loopwerk.io](https://www.loopwerk.io/articles/2024/python-uv-revisited/))
- Trying out PDM (and comparing it with Poetry and uv) ([loopwerk.io](https://www.loopwerk.io/articles/2024/trying-pdm/))
- Revisiting uv ([loopwerk.io](https://www.loopwerk.io/articles/2024/python-uv-revisited/))
- How to migrate your Poetry project to uv ([loopwerk.io](https://www.loopwerk.io/articles/2024/migrate-poetry-to-uv/))
- Zero-copy deserialization ([rkyv.org](https://rkyv.org/zero-copy-deserialization.html))
</div></script></section></div>
    </div>

    <script src="dist/reveal.js"></script>

    <script src="plugin/markdown/markdown.js"></script>
    <script src="plugin/highlight/highlight.js"></script>
    <script src="plugin/zoom/zoom.js"></script>
    <script src="plugin/notes/notes.js"></script>
    <script src="plugin/math/math.js"></script>
	<script src="plugin/mermaid/mermaid.js"></script>
	<script src="plugin/chart/chart.min.js"></script>
	<script src="plugin/chart/plugin.js"></script>
	<script src="plugin/customcontrols/plugin.js"></script>

    <script>
      function extend() {
        var target = {};
        for (var i = 0; i < arguments.length; i++) {
          var source = arguments[i];
          for (var key in source) {
            if (source.hasOwnProperty(key)) {
              target[key] = source[key];
            }
          }
        }
        return target;
      }

	  function isLight(color) {
		let hex = color.replace('#', '');

		// convert #fff => #ffffff
		if(hex.length == 3){
			hex = `${hex[0]}${hex[0]}${hex[1]}${hex[1]}${hex[2]}${hex[2]}`;
		}

		const c_r = parseInt(hex.substr(0, 2), 16);
		const c_g = parseInt(hex.substr(2, 2), 16);
		const c_b = parseInt(hex.substr(4, 2), 16);
		const brightness = ((c_r * 299) + (c_g * 587) + (c_b * 114)) / 1000;
		return brightness > 155;
	}

	var bgColor = getComputedStyle(document.documentElement).getPropertyValue('--r-background-color').trim();
	var isLight = isLight(bgColor);

	if(isLight){
		document.body.classList.add('has-light-background');
	} else {
		document.body.classList.add('has-dark-background');
	}

      // default options to init reveal.js
      var defaultOptions = {
        controls: true,
        progress: true,
        history: true,
        center: true,
        transition: 'default', // none/fade/slide/convex/concave/zoom
        plugins: [
          RevealMarkdown,
          RevealHighlight,
          RevealZoom,
          RevealNotes,
          RevealMath.MathJax3,
		  RevealMermaid,
		  RevealChart,
		  RevealCustomControls,
        ],


    	allottedTime: 120 * 1000,

		mathjax3: {
			mathjax: 'plugin/math/mathjax/tex-mml-chtml.js',
		},
		markdown: {
		  gfm: true,
		  mangle: true,
		  pedantic: false,
		  smartLists: false,
		  smartypants: false,
		},

		mermaid: {
			theme: isLight ? 'default' : 'dark',
		},

		customcontrols: {
			controls: [
			]
		},
      };

      // options from URL query string
      var queryOptions = Reveal().getQueryHash() || {};

      var options = extend(defaultOptions, {"width":960,"height":700,"margin":0.04,"controls":true,"progress":true,"slideNumber":false,"transition":"slide","transitionSpeed":"default"}, queryOptions);
    </script>

    <script>
      Reveal.initialize(options);
    </script>
  </body>

  <!-- created with Advanced Slides -->
</html>
